/**
 * Sharpen the R, G, and B bands of an image using a simple mean.
 * @param {ee.Image} img An image to sharpen. All bands should spectrally overlap
 *  the panchromatic band to avoid spectral distortion.
 * @param {ee.Image} pBand An single-band panchromatic image.
 * @return {ee.Image} The input image with all bands sharpened to the spatial 
 *  resolution of the panchromatic band.
*/
exports.sharpen = function (img, pBand) {
    var panProj = pBand.projection();

    // Resample all bands to the panchromatic resolution
    var imgSharp = img.resample('bilinear').reproject(panProj);
    // Replace each band with the mean of that band and the pan band
    imgSharp = img.add(pBand).multiply(0.5);

    return imgSharp;
}